# Чат-приложение "MassagerMAX"

## Описание проекта
Проект представляет собой многопользовательский консольный чат с клиент-серверной архитектурой, разработанный на языке Rust. Приложение поддерживает одновременное подключение нескольких клиентов, приватные сообщения, систему авторизации и журналирование всех сообщений.

## Функциональность

### Основные возможности
- **Многопользовательский сервер** - одновременная обработка подключений от нескольких клиентов
- **Система авторизации** - регистрация и вход пользователей с хэшированием паролей
- **Приватные сообщения** - личная переписка между пользователями
- **Журналирование** - сохранение истории всех сообщений в файл
- **Командный интерфейс** - интуитивно понятные команды для управления чатом

### Команды чата
- `/register <имя> <пароль>` - регистрация нового пользователя
- `/login <имя> <пароль>` - вход в систему
- `/msg <сообщение>` - отправка сообщения всем пользователям
- `/whisper <имя> <сообщение>` - отправка приватного сообщения
- `/exit` - выход из чата

## Технические требования

### Системное окружение
- **ОС**: Windows, Linux, macOS
- **Язык программирования**: Rust 1.70+
- **Сетевое подключение**: Локальная сеть или интернет

### Зависимости проекта
```toml
[dependencies]
serde_json = "1.0"        # Работа с JSON
serde = { version = "1.0", features = ["derive"] } # Сериализация
bcrypt = "0.15"           # Хэширование паролей
```

## Установка и сборка

### 1. Установка Rust
```bash
# Установка через rustup (Windows)
# Скачайте и запустите rustup-init.exe с https://rustup.rs/

# Установка через rustup (Linux/macOS)
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
source ~/.cargo/env
```

### 2. Клонирование и сборка проекта
```bash
# Создание проекта
cargo new massagermax
cd massagermax

# Замена стандартного Cargo.toml на предоставленный
# Копирование файлов server.rs и client.rs в src/bin/

# Сборка сервера и клиента
cargo build --bin server
cargo build --bin client
```

### 3. Запуск приложения
```bash
# Запуск сервера (в первом терминале)
cargo run --bin server

# Запуск клиента (во втором терминале)
cargo run --bin client

# Или запуск собранных бинарных файлов
./target/debug/server
./target/debug/client
```

## Структура проекта

```
massagermax/
├── src/
│   └── bin/
│       ├── server.rs     # Серверная часть приложения
│       └── client.rs     # Клиентская часть приложения
├── Cargo.toml            # Конфигурация зависимостей
├── users.json            # База данных пользователей (создается автоматически)
├── chat.log              # Журнал сообщений (создается автоматически)
└── README.md             # Документация проекта
```

## Использование

### Запуск и настройка
1. **Запуск сервера**: Сервер запускается на `127.0.0.1:8080` по умолчанию
2. **Подключение клиентов**: Клиенты подключаются к адресу сервера
3. **Регистрация**: Новые пользователи регистрируются командой `/register`
4. **Общение**: После входа можно отправлять сообщения всем или приватно

### Пример сессии
```
> /register иван 123456
Регистрация успешна

> /login иван 123456
Вход выполнен

> /msg Привет всем!
[иван]: Привет всем!

> /whisper петя Привет, Петя!
[ЛИЧНО для петя]: Привет, Петя!
```

### Поддерживаемые команды
| Команда | Описание | Пример |
|---------|----------|--------|
| `/register` | Регистрация нового пользователя | `/register user password` |
| `/login` | Вход в систему | `/login user password` |
| `/msg` | Отправка сообщения всем | `/msg Привет!` |
| `/whisper` | Приватное сообщение | `/whisper user Секрет` |
| `/exit` | Выход из чата | `/exit` |

## Архитектура приложения

### Серверная часть
```rust
// Основные компоненты:
// - TcpListener: Принимает входящие подключения
// - HashMap<String, TcpStream>: Хранит активные подключения
// - Многопоточность: Каждый клиент обрабатывается в отдельном потоке
// - Блокировки: Mutex для безопасного доступа к общим данным
```

### Клиентская часть
```rust
// Основные компоненты:
// - TcpStream: Подключение к серверу
// - Два потока: Один для чтения, один для записи
// - Асинхронный ввод: Чтение команд с консоли без блокировки
```

## Безопасность

### Защита данных
- **Пароли**: Хэшируются с использованием bcrypt
- **Хранение**: Данные пользователей сохраняются в `users.json`
- **Журналирование**: Все сообщения сохраняются в `chat.log`

### Ограничения
- Нет шифрования передаваемых сообщений
- Базовая аутентификация без двухфакторной защиты
- Отсутствие защиты от DDoS-атак

## Особенности реализации

### Технические решения
- **Многопоточность**: Использование `std::thread` для обработки клиентов
- **Синхронизация**: `Arc<Mutex<...>>` для безопасного доступа к общим данным
- **Сетевое взаимодействие**: Блокирующие операции чтения/записи
- **Обработка ошибок**: Базовая обработка с использованием `match` и `unwrap_or`

### Производительность
- Легковесный сервер без внешних зависимостей
- Эффективное использование памяти
- Минимальные накладные расходы на сетевой трафик

## Ограничения и известные проблемы
- Консольный интерфейс без графического оформления
- Отсутствие поддержки отправки файлов
- Нет возможности изменять настройки сервера через аргументы командной строки
- Ограниченная обработка сетевых ошибок
- Нет автоматического переподключения клиента при разрыве связи

## Разработка и расширение

### Добавление новых функций
1. **Отправка файлов**: Реализация команды `/sendfile`
2. **Шифрование**: Добавление SSL/TLS для защиты передаваемых данных
3. **Графический интерфейс**: Создание GUI с использованием библиотеки iced или egui
4. **Голосовая связь**: Интеграция аудио-коммуникации

### Сборка для распространения
```bash
# Сборка в режиме релиза
cargo build --release --bin server
cargo build --release --bin client

# Копирование исполняемых файлов
cp target/release/server /usr/local/bin/
cp target/release/client /usr/local/bin/
```

### Тестирование
```bash
# Запуск нескольких клиентов для тестирования
# В первом терминале
cargo run --bin client

# Во втором терминале
cargo run --bin client

# В третьем терминале
cargo run --bin client
```

## Планы развития

### Ближайшие улучшения
1. Добавление поддержки отправки файлов
2. Реализация комнат/каналов для общения
3. Добавление истории сообщений для новых пользователей
4. Улучшение обработки ошибок и восстановления соединения

### Долгосрочные цели
1. Создание веб-интерфейса для чата
2. Интеграция с базами данных для хранения сообщений
3. Реализация end-to-end шифрования
4. Создание мобильных клиентов

## Дополнительные материалы
- [Документация Rust](https://doc.rust-lang.org/book/)
- [Стандартная библиотека Rust](https://doc.rust-lang.org/std/)
- [Руководство по сетевому программированию на Rust](https://rust-lang.github.io/async-book/)
- [Документация bcrypt](https://docs.rs/bcrypt/)
- [Примеры многопоточных приложений](https://doc.rust-lang.org/book/ch16-00-concurrency.html)
